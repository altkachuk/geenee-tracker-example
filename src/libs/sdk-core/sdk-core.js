!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self)["@geenee/sdk-core"]=t()}(this,(function(){"use strict";const e="post get put patch del".split(" "),t=/^2\d+/,n=/^application\/json/,o=["post","put"];var r=new class{constructor(){var t=this;e.forEach((function(e){t[e]=function(n,...o){return t.request("del"===e?"delete":e,n,...o)}})),this.onFailure=this.onFailure.bind(this),this.handleResponse=this.handleResponse.bind(this)}getOptions(e,t){let n=void 0,r=null;~o.indexOf(e)&&(n=t.shift()),r=t.shift()||{};let i=r.headers||{};return i instanceof Headers||(i=new Headers(i)),!0!==r.raw&&(~o.indexOf(e)&&!1!==r.contentType&&i.append("Content-Type","application/json"),!1!==r.json&&"object"==typeof n&&(n=JSON.stringify(n))),{method:e.toUpperCase(),...r,headers:i,body:n}}onFailure(e,t,n){const o=`Error while ${e.toUpperCase()} ${t}: ${n}`;return"test"!==process.env.NODE_ENV&&console&&console.error(o),Promise.reject(new Error(o))}handleResponse(e,o,r,i){var s=this;const c=r.status,a=r.headers.get("Content-Type");let u=null;return u=i.rawResponse||!i.json&&!n.test(a)?r.text():r.json(),u.then((function(n){return t.test(c)?n:s.onFailure(e,o,r.statusText)}),(function(t){return t instanceof Error?s.onFailure(e,o,t.message||t.stack):s.onFailure(e,o,r.statusText)}))}request(e,t,...n){var o=this;const r=this.getOptions(e,n);return fetch(t,r).catch((function(n){return o.onFailure(e,t,n.message||n)})).then((function(n){return o.handleResponse(e,t,n,r)}))}};let i=document.createElement("canvas"),s=i.getContext("2d"),c="geenee";const a=function(){return{recognition:`https://${c}-recognition.geenee.io`,content:`https://${c}-content.geenee.io`}},u={recognizeImage:function(e){return new Promise((function(t,n){const[o,c]=function(e){return[0|(e.width||e.videoWidth),0|(e.height||e.videoHeight)]}(e);if(0===o||0===c)return Promise.reject(new Error("source is too small"));!function(e,t,n){i.width=t,i.height=n,s.drawImage(e,0,0,t,n)}(e,o,c),i.toBlob((function(e){r.post(a().recognition+"/api/v0/recognize-image",e,{raw:!0,headers:{"Content-Type":"application/octet-stream"}}).then(t,n)}),"image/jpeg")}))},getProject:function(e){return r.get(`${a().content}/api/v0/content/web?project_id=${e}`)},setTenant:function(e){return c=e}};return window.Geenee=u,u}));
